<!DOCTYPE html><html lang="en" itemscope itemtype="http://schema.org/WebPage"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Active Directory | Typing</title><meta name=description content=""><meta name="robots" content="index, follow"><meta name=viewport content="width=device-width, initial-scale=1"><meta http-equiv="cache-control" content="public"/><meta http-equiv="pragma" content="public"><meta name="keywords" content="Typing, Theme, Jekyll" /><meta name="author" content="Typing Theme" /><meta property="og:locale" content="en" /><meta property="og:site_name" content="Typing" /><meta property="og:type" content="WebSite" /><meta property="og:url" content="https://april-cai.github.io/blog/active-director/" /><meta property="og:description" content="Typing - A Theme for Jekyll" /><meta property="og:title" content="Active Directory - Typing" /><link rel="canonical" href="https://april-cai.github.io/blog/active-director/"><link rel="alternate" type="application/rss+xml" title="Typing" href="https://april-cai.github.io/feed.xml"> <script type="application/ld+json"> {"@context": "http://schema.org", "@type": "WebSite", "name": "Typing Theme", "headline": "Typing", "author": {"@type": "Person", "name": {"Typing"}}, "description": "Typing - A Theme for Jekyll", "url": "https://april-cai.github.io"} </script> <script type="text/javascript"> var GLOBAL_BASEURL = "https://april-cai.github.io"; </script><link rel="icon" type="image/png" sizes="32x32" href="https://april-cai.github.io/assets/images/favicon/favicon-32x32.png"><link rel="stylesheet" href="https://april-cai.github.io/assets/vendor-off/bootstrap/css/bootstrap.min.css"><link rel="stylesheet" href="https://april-cai.github.io/assets/vendor-off/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://april-cai.github.io/assets/vendor-off/fonts/space-mono/space-mono.min.css"><link rel="stylesheet" href="https://april-cai.github.io/assets/vendor-off/fonts/gloria-hallelujah/gloria-hallelujah.min.css"><link rel="stylesheet" href="https://april-cai.github.io/assets/stylesheets/main.css"></head><body><div class="main" id="top"><div class="container wrapper"><div class="row"><div class="col-sm-3 sidebar"><div class="row avatar"> <a href="https://april-cai.github.io/"> <img class="img-responsive center-block avatar-img" src="https://april-cai.github.io/assets/images/avatar/typing.svg" height="165" width="165" alt="Typing"> </a></div><div class="row header"><h2><a href="https://april-cai.github.io/">This is <br> April Cai. </a></h2></div><div class="row menu"><ul><li> <i class="fa fa-home" aria-hidden="true"></i>&nbsp;<a href="https://april-cai.github.io/">Hello</a></li><hr class="breakline"><li class="li-fa-edit"> <i style="font-size: ;" class="fa fa-edit" aria-hidden="true"></i>&nbsp;<a href="https://april-cai.github.io/blog/" >Blog</a></li><li class="li-fa-search"> <i style="font-size: ;" class="fa fa-search" aria-hidden="true"></i>&nbsp;<a href="https://april-cai.github.io/blog/search/" >Search</a></li><li class="li-fa-tags"> <i style="font-size: ;" class="fa fa-tags" aria-hidden="true"></i>&nbsp;<a href="https://april-cai.github.io/blog/tags/" >Tags</a></li><li class="li-fa-briefcase"> <i style="font-size: ;" class="fa fa-briefcase" aria-hidden="true"></i>&nbsp;<a href="https://april-cai.github.io/projects/" onclick="ga('send', 'event', 'linkTo', 'https://april-cai.github.io/projects/', 'Projects');" >Projects</a></li><li class="li-fa-file-text-o"> <i style="font-size: ;" class="fa fa-file-text-o" aria-hidden="true"></i>&nbsp;<a href="https://april-cai.github.io/resume/" onclick="ga('send', 'event', 'linkTo', 'https://april-cai.github.io/resume/', 'Resume');" >Resume</a></li><li class="li-fa-envelope"> <i style="font-size: ;" class="fa fa-envelope" aria-hidden="true"></i>&nbsp;<a href="https://april-cai.github.io/contact/" >Contact</a></li></ul><div class="socials"><div class="row"><p></p><p>Follow Me!</p><div id="github" class="col-sm-3 columns"> <a href="https://github.com/April-Cai" target="_blank" title="GitHub" onclick="ga('send', 'event', 'linkTo', 'GitHub', 'Social Network', {useBeacon: true});" > <i class="fa fa-github icon" aria-hidden="true"></i> </a></div><div id="twitter" class="col-sm-3 columns"> <a href="https://twitter.com/GarciaCai007" target="_blank" title="Twitter" onclick="ga('send', 'event', 'linkTo', 'Twitter', 'Social Network', {useBeacon: true});" > <i class="fa fa-twitter icon" aria-hidden="true"></i> </a></div><div id="gplus" class="col-sm-3 columns"> <a href="https://plus.google.com" target="_blank" title="Google Plus" onclick="ga('send', 'event', 'linkTo', 'Google Plus', 'Social Network', {useBeacon: true});" > <i class="fa fa-google-plus icon" aria-hidden="true"></i> </a></div><div id="linkedin" class="col-sm-3 columns"> <a href="https://linkedin.com" target="_blank" title="LinkedIn" onclick="ga('send', 'event', 'linkTo', 'LinkedIn', 'Social Network', {useBeacon: true});" > <i class="fa fa-linkedin icon" aria-hidden="true"></i> </a></div></div></div></div></div><div class="col-sm-9 content-main"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><div class="row title"><h1>Active Directory</h1></div><div class="row meta" datetime="2017-12-01"> <time class="col-sm-6 datetime"> <i class="fa fa-calendar" aria-hidden="true"></i><span class="text tmargin "> 01 Dezembro, 2017 </span> </time></div><div class="row tag-list"> <i class="fa fa-tags" aria-hidden="true"></i> <a href="https://april-cai.github.io/blog/tags//software_architecture">software_architecture</a></div><div class="row"> Read this in "about 1 minute".</div><div class="row content"><ul id="markdown-toc"><li><a href="#introduction" id="markdown-toc-introduction">Introduction</a></li><li><a href="#solution" id="markdown-toc-solution">Solution</a></li><li><a href="#example" id="markdown-toc-example">Example</a></li></ul><h3 id="introduction">Introduction</h3><p>These days, I am doing some work on <code>Active Directory</code> administration system meant to monitor the user, group under the same domain environment.</p><p>Suppose that there are hundreds of users in a company, administrators should add his or her entry permission to each user account. Itâ€™s quite annoying, right? So its necessary to administrate all users and create groups with different <code>authorizations</code>.</p><p>The Lightweight Directory Access Protocol (LDAP) is an open, standards-based, mature, efficient, extensible, and popular means of interacting with the data contained in directory servers.We need to bind service to it.</p><h3 id="solution">Solution</h3><p>There are two solutions in .NET framework : <a href="https://msdn.microsoft.com/en-us/library/system.directoryservices.accountmanagement(v=vs.110).aspx" target="_blank">System.DirectoryServices.AccountManagement</a> <br /> <a href="https://msdn.microsoft.com/en-us/library/mt481534(v=vs.110).aspx" target="_blank">System.DirectoryServices</a>.</p><h3 id="example">Example</h3><p>The same method of getting user by userName.<br /> Solution 1:</p><figure class="highlight"><pre><code class="language-c#" data-lang="c#"><span></span><span class="k">public</span> <span class="n">IUserInfo</span> <span class="nf">FindUser</span><span class="p">(</span><span class="kt">string</span> <span class="n">userName</span><span class="p">,</span> <span class="kt">string</span> <span class="n">password</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">de</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DirectoryEntry</span><span class="p">(</span><span class="s">&quot;LDAP://&quot;</span> <span class="p">+</span> <span class="n">_principalContext</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span> <span class="n">userName</span><span class="p">,</span> <span class="n">password</span><span class="p">))</span>
            <span class="p">{</span>
                <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">adSearch</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DirectorySearcher</span><span class="p">(</span><span class="n">de</span><span class="p">))</span>
                <span class="p">{</span>
                    <span class="n">adSearch</span><span class="p">.</span><span class="n">Filter</span> <span class="p">=</span> <span class="err">$</span><span class="s">&quot;(sAMAccountName={userName})&quot;</span><span class="p">;</span>

                    <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">adSearch</span><span class="p">.</span><span class="n">FindOne</span><span class="p">();</span>

                    <span class="k">return</span> <span class="n">result</span> <span class="p">==</span> <span class="k">null</span> <span class="p">?</span> <span class="k">null</span> <span class="p">:</span> <span class="k">new</span> <span class="n">DomainUserInfo</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">GetDirectoryEntry</span><span class="p">());</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></code></pre></figure><p>Solution 2:</p><figure class="highlight"><pre><code class="language-c#" data-lang="c#"><span></span><span class="k">public</span>  <span class="n">UserPrincipal</span> <span class="nf">GetUser</span><span class="p">(</span><span class="kt">string</span> <span class="n">userName</span><span class="p">)</span>
      <span class="p">=&gt;</span> <span class="n">UserPrincipal</span><span class="p">.</span><span class="n">FindByIdentity</span><span class="p">(</span><span class="n">_principalContext</span><span class="p">,</span> <span class="n">userName</span><span class="p">)</span></code></pre></figure><p>The difference: the former is to choose certain item by condition query, the latter is to get item directly. The former is easier, the latter is more stable.<br />PrincipalContext will connect and bind to the base directory when creating an object. While DirectoryEntry wonâ€™t bind until you execute a forced connection. As a result, PrincipalContext will get the feedback immediately of whether the connection is bound to the directory successfully.</p><div class="row sharebutton"><ul class="wrapper"><li class="title">Share</li><li class="fb"> <a href="#" title="Share on Facebook" onclick="window.open('https://www.facebook.com/sharer/sharer.php?u='+encodeURIComponent(location.href),'facebook-share-dialog','width=626,height=436');return false;">Facebook</a></li><li class="linkedin"> <a href="http://www.linkedin.com/cws/share?url=https://april-cai.github.io/blog/active-director/" onclick="window.open(this.href,&quot;popupwindow&quot;,&quot;status=0,height=500,width=700,resizable=0,top=50,left=100&quot;);return false;" target="_blank" title="Share on LinkedIn">Linkedin</a></li><li class="googleplus"> <a href="https://plus.google.com/share?url=https://april-cai.github.io/blog/active-director/" onclick="window.open(this.href,&quot;popupwindow&quot;,&quot;status=0,height=500,width=700,resizable=0,top=50,left=100&quot;);return false;" target="_blank" title="Share on Google Plus">Google+</a></li></ul></div><div class="day-quote"><div class="title"></div><div class="content"></div></div><div class="row author"><div class="col-sm-2 image"> <img class="img-responsive center-block" src="https://april-cai.github.io/assets/images/author/typing.svg" alt=""></div><div class="col-sm-10 bio"><p class="title">Author</p><p class="name">Typing Theme</p><p class="content">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Tempora non aut eos voluptas debitis unde impedit aliquid ipsa.</p></div></div><div class="disqus" id="comments"><div class="title"><h3><i class="fa fa-comments" aria-hidden="true"></i>&nbsp;The comment for this post is disabled.</h3></div></div></div></article></div></div></div><div class="footer"><div class="container-fluid"><div class="row-fluid"><div class="col-sm-4 copyright"> <span>Typing Â© 2016-2019 â€¢ All right reserved.</span></div><div class="col-sm-4 message"> <span>Simplicity is fashionable.</span></div><div class="col-sm-4 madeby"> <span>Made with&nbsp;<a href="https://jekyllrb.com" target="_blank">Jekyll</a>&nbsp;using&nbsp;<a href="https://github.com/williamcanin/typing-jekyll-template" target="_blank">Typing</a>&nbsp;Theme.</span></div><a class="pull-right top" href="#top"><i class="fa fa-caret-up" aria-hidden="true"></i></a></div></div></div></div><script src="https://april-cai.github.io/assets/vendor-off/jquery/js/jquery.min.js"></script> <script src="https://april-cai.github.io/assets/vendor-off/bootstrap/js/bootstrap.min.js"></script> <script src="https://april-cai.github.io/assets/javascripts/jekyll-spotify-plugin.min.js"></script> <script type="text/javascript" src="https://april-cai.github.io/assets/javascripts/post.js"></script> <script type="text/javascript"> jQuery(document).ready(function($) { $('.post > .row.content a').addClass('ga-event'); $('.page.spage > .row.content th a').addClass('ga-event'); $('.row.content li a').removeClass('ga-event'); $('a.ga-event').attr('onclick', 'ga(\'send\',\'event\',\'linkTo\',this.href,\'https://april-cai.github.io/blog/active-director/\');'); }); </script> <script src="https://april-cai.github.io/assets/javascripts/global.js"></script></body></html>
