<!DOCTYPE html><html lang="en" itemscope itemtype="http://schema.org/WebPage"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>ML Naive Bayes | Typing</title><meta name=description content=""><meta name="robots" content="index, follow"><meta name=viewport content="width=device-width, initial-scale=1"><meta http-equiv="cache-control" content="public"/><meta http-equiv="pragma" content="public"><meta name="keywords" content="Typing, Theme, Jekyll" /><meta name="author" content="Typing Theme" /><meta property="og:locale" content="en" /><meta property="og:site_name" content="Typing" /><meta property="og:type" content="WebSite" /><meta property="og:url" content="https://april-cai.github.io/blog/ML3/" /><meta property="og:description" content="Typing - A Theme for Jekyll" /><meta property="og:title" content="ML Naive Bayes - Typing" /><link rel="canonical" href="https://april-cai.github.io/blog/ML3/"><link rel="alternate" type="application/rss+xml" title="Typing" href="https://april-cai.github.io/feed.xml"> <script type="application/ld+json"> {"@context": "http://schema.org", "@type": "WebSite", "name": "Typing Theme", "headline": "Typing", "author": {"@type": "Person", "name": {"Typing"}}, "description": "Typing - A Theme for Jekyll", "url": "https://april-cai.github.io"} </script> <script type="text/javascript"> var GLOBAL_BASEURL = "https://april-cai.github.io"; </script><link rel="icon" type="image/png" sizes="32x32" href="https://april-cai.github.io/assets/images/favicon/favicon-32x32.png"><link rel="stylesheet" href="https://april-cai.github.io/assets/vendor-off/bootstrap/css/bootstrap.min.css"><link rel="stylesheet" href="https://april-cai.github.io/assets/vendor-off/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://april-cai.github.io/assets/vendor-off/fonts/space-mono/space-mono.min.css"><link rel="stylesheet" href="https://april-cai.github.io/assets/vendor-off/fonts/gloria-hallelujah/gloria-hallelujah.min.css"><link rel="stylesheet" href="https://april-cai.github.io/assets/stylesheets/main.css"></head><body><div class="main" id="top"><div class="container wrapper"><div class="row"><div class="col-sm-3 sidebar"><div class="row avatar"> <a href="https://april-cai.github.io/"> <img class="img-responsive center-block avatar-img" src="https://april-cai.github.io/assets/images/avatar/typing.svg" height="165" width="165" alt="Typing"> </a></div><div class="row header"><h2><a href="https://april-cai.github.io/">This is <br> April Cai. </a></h2></div><div class="row menu"><ul><li> <i class="fa fa-home" aria-hidden="true"></i>&nbsp;<a href="https://april-cai.github.io/">Hello</a></li><hr class="breakline"><li class="li-fa-edit"> <i style="font-size: ;" class="fa fa-edit" aria-hidden="true"></i>&nbsp;<a href="https://april-cai.github.io/blog/" >Blog</a></li><li class="li-fa-search"> <i style="font-size: ;" class="fa fa-search" aria-hidden="true"></i>&nbsp;<a href="https://april-cai.github.io/blog/search/" >Search</a></li><li class="li-fa-tags"> <i style="font-size: ;" class="fa fa-tags" aria-hidden="true"></i>&nbsp;<a href="https://april-cai.github.io/blog/tags/" >Tags</a></li><li class="li-fa-briefcase"> <i style="font-size: ;" class="fa fa-briefcase" aria-hidden="true"></i>&nbsp;<a href="https://april-cai.github.io/projects/" onclick="ga('send', 'event', 'linkTo', 'https://april-cai.github.io/projects/', 'Projects');" >Projects</a></li><li class="li-fa-file-text-o"> <i style="font-size: ;" class="fa fa-file-text-o" aria-hidden="true"></i>&nbsp;<a href="https://april-cai.github.io/resume/" onclick="ga('send', 'event', 'linkTo', 'https://april-cai.github.io/resume/', 'Resume');" >Resume</a></li><li class="li-fa-envelope"> <i style="font-size: ;" class="fa fa-envelope" aria-hidden="true"></i>&nbsp;<a href="https://april-cai.github.io/contact/" >Contact</a></li></ul><div class="socials"><div class="row"><p></p><p>Follow Me!</p><div id="github" class="col-sm-3 columns"> <a href="https://github.com/April-Cai" target="_blank" title="GitHub" onclick="ga('send', 'event', 'linkTo', 'GitHub', 'Social Network', {useBeacon: true});" > <i class="fa fa-github icon" aria-hidden="true"></i> </a></div><div id="twitter" class="col-sm-3 columns"> <a href="https://twitter.com/GarciaCai007" target="_blank" title="Twitter" onclick="ga('send', 'event', 'linkTo', 'Twitter', 'Social Network', {useBeacon: true});" > <i class="fa fa-twitter icon" aria-hidden="true"></i> </a></div><div id="gplus" class="col-sm-3 columns"> <a href="https://plus.google.com" target="_blank" title="Google Plus" onclick="ga('send', 'event', 'linkTo', 'Google Plus', 'Social Network', {useBeacon: true});" > <i class="fa fa-google-plus icon" aria-hidden="true"></i> </a></div><div id="linkedin" class="col-sm-3 columns"> <a href="https://linkedin.com" target="_blank" title="LinkedIn" onclick="ga('send', 'event', 'linkTo', 'LinkedIn', 'Social Network', {useBeacon: true});" > <i class="fa fa-linkedin icon" aria-hidden="true"></i> </a></div></div></div></div></div><div class="col-sm-9 content-main"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><div class="row title"><h1>ML Naive Bayes</h1></div><div class="row meta" datetime="2019-01-21"> <time class="col-sm-6 datetime"> <i class="fa fa-calendar" aria-hidden="true"></i><span class="text tmargin "> 21 Janeiro, 2019 </span> </time></div><div class="row tag-list"> <i class="fa fa-tags" aria-hidden="true"></i> <a href="https://april-cai.github.io/blog/tags//machine_learning">machine_learning</a></div><div class="row"> Read this in "about 3 minutes".</div><div class="row content"><ul id="markdown-toc"><li><a href="#input--output" id="markdown-toc-input--output">Input &amp; output</a></li><li><a href="#main-idea" id="markdown-toc-main-idea">Main idea</a></li><li><a href="#learning-method" id="markdown-toc-learning-method">Learning method</a></li><li><a href="#parameter-estimation" id="markdown-toc-parameter-estimation">Parameter estimation</a></li><li><a href="#example-in-practise" id="markdown-toc-example-in-practise">Example in practise</a></li></ul><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script><blockquote><p>Naive Bayes is a classifier which is based on Bayes equation and conditional independence.</p></blockquote><h2 id="input--output">Input &amp; output</h2><p>input: <script type="math/tex">x=(x_{1},x_{2},...,x_{d})</script>, <script type="math/tex">d</script> is the dimension of feature vector <script type="math/tex">x</script>. output: <script type="math/tex">y \in {c_1, c_2, ..., c_K}</script>, <script type="math/tex">y</script> is the class label in <script type="math/tex">K</script> classes. <br /><br /></p><h2 id="main-idea">Main idea</h2><p>Based on Bayes equation</p><script type="math/tex; mode=display">P(w|x) = \frac {p(x|w) P(w)}{P(x)}\\ = \frac {p(w, x)}{P(x)}</script><p><script type="math/tex">P(x|w)</script> is the <code>likelihood</code>, <script type="math/tex">P(w)</script> is <code>prior probability</code>. <script type="math/tex">P(x)</script> is the <code>evidence</code>, and <script type="math/tex">P(w|x)</script> is the <code>posterior probability</code>. The likelihood is the conditional probability, the evidence is the const value and P(w|x) is the probability we wanna solve given likelihood and evidence.<br /> Here to fresh your memory, you can think of <script type="math/tex">x</script> as a phenomenon and <script type="math/tex">w</script> as a rule. <br /><br /></p><h2 id="learning-method">Learning method</h2><p>1.First we have to understand from the very beginning, we are definitely want to figure out the conditional probability. The conditional probability is meant for every class in every dimension of feature vector <script type="math/tex">x</script>, the appearance of all possible values.<br /> Then we can apply conditional independence theory to calculate the combined probability.</p><script type="math/tex; mode=display">P(X = x | Y = c_{k}) = P(X_{1} = x_{1}, X_{2} = x_{2},..., X_{d} = x_{d} | Y = c_{k})\\ = \prod_{i=1}^{n} P(X_{i} = x_{i} | Y = c_{k})</script><p>Then for every dimension <script type="math/tex">i</script> in <script type="math/tex">n</script>, <script type="math/tex">x_{i}</script> have <script type="math/tex">S_{i}</script> values, the total number of parameters for K classes is <script type="math/tex">K \prod_{i=1}^{n} S_{i}</script>. Itâ€™s really hard to predict so many parameters.</p><p>2.Instead, we can figuring out <script type="math/tex">P(Y = c_{k} | X = x)</script>. <br /> I think this alternative method is not to cover all possible <script type="math/tex">x</script>, it only focuses the instance we want to predict.</p><script type="math/tex; mode=display">P(Y = c_{k} \mid X = x) = \frac { P(X = x \mid Y = c_{k}) P(Y = c_{k}) }{ P(X = x) }\\ = \frac { P(X = x \mid Y = c_{k}) P(Y = c_{k}) }{ \sum_{K} P(Y = c{k}) \prod_{i} P(X_{i} = x_{i} \mid Y = c_{k}) }\\ = \frac { \prod_{i}P(X_{i} = x_{i} \mid Y = c_{k}) P(Y = c_{k}) }{ \sum_{K} P(Y = c{k}) \prod_{i} P(X_{i} = x_{i} \mid Y = c_{k}) }\\</script><p>3.So we can calculate for every class <script type="math/tex">c_{k}</script> and find the maximum,</p><script type="math/tex; mode=display">y = f(x) = argmax_{c_{k}}\frac { \prod_{i}P(X_{i} = x_{i} \mid Y = c_{k}) P(Y = c_{k}) }{ \sum_{K} P(Y = c{k}) \prod_{i} P(X_{i} = x_{i} \mid Y = c_{k}) }\\</script><p>Ignoring the same denominator, we get:</p><script type="math/tex; mode=display">y = f(x) = argmax_{c_{k}} { \prod_{i}P(X_{i} = x_{i} \mid Y = c_{k}) P(Y = c_{k}) }\\</script><p>Finally:) we easily apply the Bayes equation to decide the class of give instance <script type="math/tex">x</script>. <br /><br /></p><h2 id="parameter-estimation">Parameter estimation</h2><p>1.Maximum likelihood<br /> To calculate: <br /> <script type="math/tex">y = argmax_{c_{k}} { \prod_{i} P(X_{i} = x_{i} \mid Y = c_{k}) P(Y = c_{k})}</script><br /> <br /></p><p>That is to calculate <br /> <script type="math/tex">P(y = c_{k}) = \frac {\sum_{i=1}^N I(y_{i} = c_{k})}{N}, k = 1,2,...,K\\ P(X_{i} = x_{ij} \mid Y = c_{k}) = \frac {\sum_{i=1}^N I(X_{i} = x_{ij}, y_{i} = c_{k})}{\sum_{i=1}^N I(y_{i} = c_{k})}, x_{i} \in \{x_{i1},x_{i2},...,x_{iS_{i}}\}</script><br /> <br /></p><p>2.Bayes estimation<br /> <script type="math/tex">P_{\lambda}(y = c_{k}) = \frac {\sum_{i=1}^N I(y_{i} = c_{k}) + \lambda}{N+K\lambda}, k = 1,2,...,K\\ P_{\lambda}(X_{i} = x_{ij} \mid Y = c_{k}) = \frac {\sum_{i=1}^N I(X_{i} = x_{ij}, y_{i} = c_{k}) + \lambda}{\sum_{i=1}^N I(y_{i} = c_{k}) + S_{i}\lambda}, x_{i} \in \{x_{i1},x_{i2},...,x_{iS_{i}}\}</script><br /> <br /></p><p>The only difference is to add Laplace smoothing, to make <br /> <script type="math/tex">P \gt 0\\ \sum_{k=1}^{K}P_{k} = 1</script> <br /><br /></p><h2 id="example-in-practise">Example in practise</h2><p><a href="https://github.com/April-Cai/Machine-learning/blob/master/3_nb.ipynb">IPython file</a></p><p><br /><br /></p><p>Goodbye!</p><hr style="border-top: 1px solid #9D9D9D ; color: #9D9D9D ;" class="endpost" /><div class="row sharebutton"><ul class="wrapper"><li class="title">Share</li><li class="fb"> <a href="#" title="Share on Facebook" onclick="window.open('https://www.facebook.com/sharer/sharer.php?u='+encodeURIComponent(location.href),'facebook-share-dialog','width=626,height=436');return false;">Facebook</a></li><li class="linkedin"> <a href="http://www.linkedin.com/cws/share?url=https://april-cai.github.io/blog/ML3/" onclick="window.open(this.href,&quot;popupwindow&quot;,&quot;status=0,height=500,width=700,resizable=0,top=50,left=100&quot;);return false;" target="_blank" title="Share on LinkedIn">Linkedin</a></li><li class="googleplus"> <a href="https://plus.google.com/share?url=https://april-cai.github.io/blog/ML3/" onclick="window.open(this.href,&quot;popupwindow&quot;,&quot;status=0,height=500,width=700,resizable=0,top=50,left=100&quot;);return false;" target="_blank" title="Share on Google Plus">Google+</a></li></ul></div><div class="day-quote"><div class="title"></div><div class="content"></div></div><div class="row author"><div class="col-sm-2 image"> <img class="img-responsive center-block" src="https://april-cai.github.io/assets/images/author/typing.svg" alt=""></div><div class="col-sm-10 bio"><p class="title">Author</p><p class="name">Typing Theme</p><p class="content">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Tempora non aut eos voluptas debitis unde impedit aliquid ipsa.</p></div></div><div class="disqus" id="comments"><div class="title"><h3><i class="fa fa-comments" aria-hidden="true"></i>&nbsp;The comment for this post is disabled.</h3></div></div></div></article></div></div></div><div class="footer"><div class="container-fluid"><div class="row-fluid"><div class="col-sm-4 copyright"> <span>Typing Â© 2016-2019 â€¢ All right reserved.</span></div><div class="col-sm-4 message"> <span>Simplicity is fashionable.</span></div><div class="col-sm-4 madeby"> <span>Made with&nbsp;<a href="https://jekyllrb.com" target="_blank">Jekyll</a>&nbsp;using&nbsp;<a href="https://github.com/williamcanin/typing-jekyll-template" target="_blank">Typing</a>&nbsp;Theme.</span></div><a class="pull-right top" href="#top"><i class="fa fa-caret-up" aria-hidden="true"></i></a></div></div></div></div><script src="https://april-cai.github.io/assets/vendor-off/jquery/js/jquery.min.js"></script> <script src="https://april-cai.github.io/assets/vendor-off/bootstrap/js/bootstrap.min.js"></script> <script src="https://april-cai.github.io/assets/javascripts/jekyll-spotify-plugin.min.js"></script> <script type="text/javascript" src="https://april-cai.github.io/assets/javascripts/post.js"></script> <script type="text/javascript"> jQuery(document).ready(function($) { $('.post > .row.content a').addClass('ga-event'); $('.page.spage > .row.content th a').addClass('ga-event'); $('.row.content li a').removeClass('ga-event'); $('a.ga-event').attr('onclick', 'ga(\'send\',\'event\',\'linkTo\',this.href,\'https://april-cai.github.io/blog/ML3/\');'); }); </script> <script src="https://april-cai.github.io/assets/javascripts/global.js"></script></body></html>
